generator client {
  provider = "prisma-client-js"
  engineType = "library"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id            String    @id @default(cuid())
  name          String?
  email         String    @unique
  password      String?   // For credentials auth
  image         String?
  role          String    @default("USER") // ADMIN or USER
  createdAt     DateTime  @default(now())
  updatedAt     DateTime  @updatedAt
  
  orders        Order[]
}

model Product {
  id          String   @id @default(cuid())
  title       String
  description String
  price       Int      // in cents/paise
  pdfUrl      String
  videoUrl    String
  thumbnail   String
  features    String   // Store as JSON string or comma-separated for SQLite simplicity
  category    String   @default("Uncategorized")
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  orders      Order[]
}

model Order {
  id            String   @id @default(cuid())
  userId        String
  productId     String
  amount        Int
  status        String   @default("PENDING") // PENDING, COMPLETED
  transactionId String?
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt

  user    User    @relation(fields: [userId], references: [id])
  product Product @relation(fields: [productId], references: [id], onDelete: Cascade)
}
